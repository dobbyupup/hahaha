<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¿«ä¹å°±æ˜¯å“ˆå“ˆå“ˆï½œæ®µå­è½®æ’­</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              bg: '#0a0a0a',
              fg: '#ffffff',
              soft: '#1a1a1a',
              mute: '#9ca3af'
            }
          },
          boxShadow: {
            soft: '0 10px 30px rgba(0,0,0,0.15)'
          }
        }
      }
    }
  </script>
  <style>
    /* å¹³æ»‘è¿›å‡ºåœºåŠ¨ç”» */
    .fade-enter { opacity: 0; transform: translateY(8px); }
    .fade-enter-active { opacity: 1; transform: translateY(0); transition: all 500ms ease; }
    .fade-exit { opacity: 1; transform: translateY(0); }
    .fade-exit-active { opacity: 0; transform: translateY(-8px); transition: all 400ms ease; }
  </style>
</head>
<body class="min-h-dvh bg-black text-white selection:bg-white selection:text-black">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <header class="sticky top-0 z-40 border-b border-white/10 backdrop-blur">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 items-center justify-between">
        <a href="#" class="inline-flex items-center gap-3 group" aria-label="é¦–é¡µ - å¿«ä¹å°±æ˜¯å“ˆå“ˆå“ˆ">
          <span class="h-9 w-9 grid place-items-center rounded-full bg-white text-black font-bold">å“ˆ</span>
          <div class="leading-tight">
            <div class="font-semibold tracking-tight">å¿«ä¹å°±æ˜¯å“ˆå“ˆå“ˆ</div>
            <div class="text-xs text-white/60">æç®€ Â· çº¯ HTML + Tailwind</div>
          </div>
        </a>
        <nav class="flex items-center gap-2 sm:gap-4">
          <button id="viewJokesBtn" class="px-3 py-2 text-sm rounded-xl hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/20">æ®µå­</button>
          <button id="viewFavsBtn" class="px-3 py-2 text-sm rounded-xl hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/20">æ”¶è—</button>
          <div class="w-px h-6 bg-white/10 mx-1"></div>
          <button id="loginBtn" class="px-3 py-2 text-sm rounded-xl bg-white text-black font-medium hover:opacity-90 hidden">ç™»å½•</button>
          <div id="userMenu" class="relative">
            <button id="userBtn" class="hidden px-3 py-2 text-sm rounded-xl bg-white/10 hover:bg-white/20 aria-expanded=false">ğŸ‘¤ <span id="usernameText" class="ml-1 align-middle"></span></button>
            <div id="userDropdown" class="hidden absolute right-0 mt-2 w-48 rounded-xl bg-white text-black shadow-soft overflow-hidden">
              <button id="logoutBtn" class="w-full text-left px-4 py-3 text-sm hover:bg-black/5">é€€å‡ºç™»å½•</button>
              <button id="clearFavBtn" class="w-full text-left px-4 py-3 text-sm hover:bg-black/5">æ¸…ç©ºæ”¶è—</button>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </header>

  <!-- ä¸»ä½“åŒºåŸŸ -->
  <main class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
    <!-- è¿›åº¦æ¡ -->
    <div class="h-1 w-full bg-white/10 rounded-full overflow-hidden mt-8" aria-hidden="true">
      <div id="progress" class="h-full w-0 bg-white"></div>
    </div>

    <!-- æ®µå­å¡ç‰‡ -->
    <section id="jokesSection" class="relative mt-8">
      <article aria-live="polite" aria-atomic="true" class="rounded-3xl border border-white/10 bg-white/5 p-8 md:p-12 shadow-soft">
        <div class="flex items-start justify-between gap-4">
          <div class="text-sm uppercase tracking-widest text-white/50">ä»Šæ—¥ç¬‘ç‚¹</div>
          <button id="favBtn" class="inline-flex items-center gap-2 rounded-xl border border-white/10 px-3 py-2 hover:bg-white hover:text-black transition" aria-pressed="false" title="æ”¶è—/å–æ¶ˆæ”¶è—">
            <span id="favIcon">â˜†</span><span class="text-sm">æ”¶è—</span>
          </button>
        </div>
        <div id="jokeText" class="mt-6 text-2xl md:text-3xl leading-relaxed font-medium"></div>
        <div class="mt-6 flex items-center justify-between text-sm text-white/60">
          <div>
            <span id="jokeIndex">1</span>/<span id="jokeTotal">â€”</span>
            <span class="mx-2">Â·</span>
            <span>æ¯ 1 åˆ†é’Ÿè‡ªåŠ¨æ›´æ¢</span>
          </div>
          <div class="flex items-center gap-2">
            <button id="prevBtn" class="px-3 py-2 rounded-lg hover:bg-white/10">ä¸Šä¸€æ¡</button>
            <button id="nextBtn" class="px-3 py-2 rounded-lg hover:bg-white/10">ä¸‹ä¸€æ¡</button>
            <button id="pauseBtn" class="px-3 py-2 rounded-lg hover:bg-white/10">æš‚åœ</button>
          </div>
        </div>
      </article>
    </section>

    <!-- æ”¶è—åˆ—è¡¨ -->
    <section id="favsSection" class="hidden mt-10">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold tracking-tight">æˆ‘çš„æ”¶è—</h2>
        <div class="text-sm text-white/60" id="favCountLabel"></div>
      </div>
      <ul id="favList" class="mt-4 grid gap-4"></ul>
      <div id="noFavTip" class="hidden mt-8 text-center text-white/50">æš‚æ— æ”¶è—ã€‚å»æµè§ˆæ®µå­ï¼Œç‚¹å‡»â€œæ”¶è—â€ä¿å­˜å–œæ¬¢çš„å†…å®¹ã€‚</div>
    </section>

    <footer class="py-16 text-center text-xs text-white/40">
      Â© <span id="year"></span> å¿«ä¹å°±æ˜¯å“ˆå“ˆå“ˆ Â· æç®€é»‘ç™½é£ Â· çº¯ HTML + TailwindCSS
    </footer>
  </main>

  <!-- ç™»å½•å¯¹è¯æ¡† -->
  <div id="loginModal" class="fixed inset-0 hidden items-center justify-center bg-black/60 p-4 z-50" role="dialog" aria-modal="true">
    <div class="w-full max-w-md rounded-2xl bg-white text-black p-6 shadow-soft">
      <div class="flex items-start justify-between">
        <h3 class="text-lg font-semibold">ç™»å½•</h3>
        <button id="loginClose" class="p-2 -m-2" aria-label="å…³é—­">âœ•</button>
      </div>
      <p class="mt-1 text-sm text-gray-600">ä¸ºäº†ä¿å­˜æ”¶è—ï¼Œæˆ‘ä»¬é‡‡ç”¨æœ¬åœ°å®‰å…¨ç™»å½•ï¼ˆä»…ä¿å­˜åœ¨ä½ çš„æµè§ˆå™¨ï¼‰ã€‚</p>
      <form id="loginForm" class="mt-6 space-y-4">
        <div>
          <label class="block text-sm mb-1" for="loginName">ç”¨æˆ·å</label>
          <input id="loginName" required autocomplete="username" class="w-full rounded-xl border border-black/10 px-3 py-2 outline-none focus:ring-2 focus:ring-black/10" placeholder="å¦‚ï¼šhahaha" />
        </div>
        <div>
          <label class="block text-sm mb-1" for="loginPass">å¯†ç </label>
          <input id="loginPass" type="password" required autocomplete="current-password" class="w-full rounded-xl border border-black/10 px-3 py-2 outline-none focus:ring-2 focus:ring-black/10" placeholder="æœ€å°‘ 4 ä½" minlength="4" />
        </div>
        <button class="w-full rounded-xl bg-black text-white py-2.5 hover:opacity-90">è¿›å…¥</button>
      </form>
      <p class="mt-3 text-xs text-gray-500">æç¤ºï¼šæ­¤ç™»å½•ä»…ç”¨äºåœ¨æœ¬åœ°è®¾å¤‡åŒºåˆ†ç”¨æˆ·ä¸æ”¶è—ï¼Œä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</p>
    </div>
  </div>

  <script>
    // ---------------- åŸºç¡€æ•°æ®ï¼ˆç¤ºä¾‹æ®µå­ï¼Œå¯æ›¿æ¢ä¸ºä½ çš„å†…å®¹ï¼‰ ----------------
    const JOKES = [
  `æœ‹å‹é—®æˆ‘ï¼šâ€œä½ ä¸ºä»€ä¹ˆæ€»æ˜¯ç¬‘ï¼Ÿâ€ æˆ‘è¯´ï¼šâ€œå› ä¸ºå“­å¤ªè´µäº†ï¼ŒæŠ¤è‚¤å“æ‰¿å—ä¸èµ·ã€‚â€`,
  `ä»Šå¤©å†³å®šå‡è‚¥ï¼Œäºæ˜¯æˆ‘æŠŠä½“é‡ç§¤è—äº†èµ·æ¥ã€‚é—®é¢˜è§£å†³äº†ï¼`,
  `é¢è¯•å®˜ï¼šä½ çš„ä¼˜ç‚¹ï¼Ÿæˆ‘ï¼šä¼šè‡ªæˆ‘åçœã€‚é¢è¯•å®˜ï¼šç¼ºç‚¹ï¼Ÿæˆ‘ï¼šåçœåä¹Ÿä¸æ”¹ã€‚`,
  `å¥èº«å¡ä¹°äº†ä¸‰å¹´ï¼Œæ•™ç»ƒè¯´æˆ‘å¾ˆç¨³å®šï¼Œæˆ‘è§‰å¾—ä»–è¯é‡Œæœ‰è¯ã€‚`,
  `å­˜æ¬¾å’Œèº«é«˜ä¸€æ ·ï¼Œéƒ½æ˜¯æˆ‘ä¸æ„¿æ„æèµ·çš„è¯é¢˜ã€‚`,
  `ä¸€å“¥ä»¬åœ¨è·¯ä¸Š ä¸ä¸€ç¾å¥³æ­è®ª è¯´ï¼šç¾å¥³ä½ çœŸæ¼‚äº®ï¼Œ è¯·é—®ä½ æ˜¯åšä»€ä¹ˆå·¥ä½œçš„ã€‚ ç¾å¥³è¯´ æˆ‘æ˜¯å¹²æœåŠ¡å·¥ä½œçš„ è¿™å“¥ä»¬æ¬£å–œçš„è¯´ï¼š æˆ‘å¥½æƒ³æˆä¸ºä½ çš„é¡¾å®¢ï¼è¯·é—®ä½ åœ¨å“ªé‡Œä¸Šç­ ç¾å¥³è¯´ æˆ‘åœ¨ç«è‘¬åœºæœåŠ¡ ä½ å•¥æ—¶å€™èƒ½è¿‡æ¥`,
  `æˆ‘æ¯æ—¥åŠ³ç¢Œï¼Œæœäº”æ™šä¹è¿˜è¦åŠ ç­ã€‚ æˆ‘å¯»è‡³å¯ºåº™ï¼Œå‘å¤§å¸ˆå€¾è¯‰:â€œå¤§å¸ˆï¼Œæˆ‘å·²çœ‹é€å°˜ä¸–çº·æ‰°ï¼Œæ„¿å‡ºå®¶ã€‚â€ å¤§å¸ˆè¾¹ä¸ºæˆ‘å‰ƒå‘ï¼Œè¾¹å«æ³ªæˆè¨€ï¼šâ€œå­©å­ï¼Œä½ æ¯æœˆçš†æ¥æ­¤åœ°ï¼Œå±±ä¸‹ç†å‘åº—æœ‰é‚£ä¹ˆè´µå—?`,
  `è®°è€…è¡—å¤´é‡‡è®¿:â€œå¤§å¦ˆï¼Œæ‚¨è§‰å¾—é›¾éœ¾ç»™æ‚¨çš„ç”Ÿæ´»å¸¦æ¥äº†ä»€ä¹ˆå½±å“?â€ å¤§å¦ˆ:â€œå½±å“å¤ªå¤§äº†!é¦–å…ˆä½ å¾—çœ‹æ¸…æ¥šï¼Œæˆ‘æ˜¯ä½ å¤§çˆ·!â€`,
  `æˆ‘çˆ¸å–œæ¬¢åƒè‚‰ï¼Œæˆ‘å¦ˆä»Šå¤©åªç‚’äº†å‡ ä¸ªç´ èœ æˆ‘çˆ¸æŠ±æ€¨è¯´ï¼Œæ€ä¹ˆåªæœ‰ç´ èœå•Šï¼ æˆ‘å¦ˆè¯´:"çˆ±åƒä¸åƒï¼Œä¸åƒå–‚ç‹—"è¯´ç€è¯´ç€å°±æŠŠèœå°±å¤¹åˆ°äº†æˆ‘ç¢—é‡Œ.`,
  `å»æ‰¾è€æ¿ç”³è¯·è¡¥ä¼‘ï¼Œè¿›äº†åŠå…¬å®¤å¬åˆ°ä¸€åŒäº‹è¯´ï¼šå¥½çš„ï¼Œæ˜å¤©æˆ‘ä¼‘ã€‚ æˆ‘è¿å¿™è¯´ï¼šæ˜å¤©æˆ‘ä¹Ÿæƒ³ä¼‘ã€‚ è€æ¿æ„£äº†ä¸€ä¸‹è¯´ï¼šå¥½å§æ˜å¤©ä½ ä¿©ä¸€èµ·ï¼Œé‚£é©¬æ¡¶èƒ½ä¿®å°±ä¿®ï¼Œä¸èƒ½ä¿®å°±æ¢ä¸€ä¸ªã€‚`,
  `æ™å­ä½¿æ¥šï¼Œæ™å­è¢«äººç¾è¾±åç¦»å¼€, æœ‰è®¤è¯†æ™å­çš„å¤§è‡£ä¸€å¬ï¼Œ æ€¥å¿™å»è¿½ï¼Œè¯´ æ™å­ï¼æ™å­ï¼æ²¡æœ‰ä½ æˆ‘å¯æ€ä¹ˆæ´»å•Š!`,
  `è¿ªè¿¦æ˜¯å“ªé‡Œçš„ï¼Œä¸œåŒ—çš„ï¼Œ å› ä¸ºæˆ‘è¿ªè¿¦åœ¨ä¸œåŒ—ã€‚`,
  `å°æ˜ç”Ÿç—…äº†ï¼Œåƒäº†è¯å´ä¸€ç›´ç¬‘ï¼Œä¸ºä»€ä¹ˆ å› ä¸ºåŒ»ç”Ÿå‘Šè¯‰å°æ˜è¿™è¯æ•ˆï¼ˆè¦ç¬‘ï¼‰ä¸€å°æ—¶`,
  `åˆ°äº†è¿™ä¸ªå¹´çºª ä¼šåœ¨ä½ è€³è¾¹å”±æ­Œå–œæ¬¢ä½ çš„èº«ä½“è¿˜é€ä½ åŒ…çš„åªå‰©ä¸‹èšŠå­äº†`,
  `åˆ°äº†è¿™ä¸ªå¹´çºª ä¼šåœ¨ä½ è€³è¾¹å”±æ­Œå–œæ¬¢ä½ çš„èº«ä½“è¿˜é€ä½ åŒ…çš„åªå‰©ä¸‹èšŠå­äº†`,
  `è•è¿‘ä½“é‡ä¸‹é™äº†ç»å¯¹æ²¡æœ‰å‡è‚¥åªæ˜¯å·å·æŠŠå¿ƒé‡Œçš„åå…«ä¸ªç”·äººæ”¾ä¸‹äº†`,
  `åœ¨æ¸¸æ³³åœ°æˆæ°´ï¼Œ çªç„¶æƒ³æ”¾å±ã€‚æ²¡æ†‹ä½ï¼Œ èº«åå†’èµ·ä¸€å¤§ä¸²æ³¡æ³¡ã€‚æ—è¾¹å°å§‘å¨˜å“‡åœ°ä¸€å£°å“­äº†:â€œå¦ˆå¦ˆå¿«è·‘ï¼Œæ°´å¼€äº†ï¼`,
  `æˆ‘å®¶æ¥¼ä¸‹æ–°å¼€äº†ä¸€å®¶å¥èº«æˆ¿ï¼ŒåŠå¡é€ä½“è„‚ç§°ã€‚æˆ‘ä¸€ä¸Šå»ï¼Œä½“è„‚ç§°æ˜¾ç¤ºâ€œè¿æ¥å¤±è´¥â€ï¼Œæˆ‘å¾ˆæ„ŸåŠ¨ï¼šè¿æœºå™¨éƒ½æ‹’ç»å’Œæˆ‘å»ºç«‹è¿‡äºäº²å¯†çš„å…³ç³»ã€‚æ•™ç»ƒçœ‹æˆ‘çŠ¹è±«ï¼Œæ‹ç€èƒ¸è„¯è¯´ï¼šâ€œæ”¾å¿ƒï¼Œæˆ‘ä»¬ä¿è¯è®©ä½ ç˜¦ä¸‹æ¥ã€‚â€æˆ‘é—®æ€ä¹ˆä¿è¯ï¼Ÿä»–è¯´ï¼šâ€œæˆ‘ä»¬æŠŠé•œå­è°ƒå¾—ç‰¹åˆ«ç˜¦ã€‚â€`,
  `çœ‹ç€åˆšå‡ºç”Ÿä¸åˆ°ä¸€ä¸ªæœˆçš„å¤–ç”¥å¥³ï¼Œ æˆ‘æ‘¸ç€å¥¹çš„å°è„¸è¯´:â€œè¿™ä¸ªå°è„¸åˆå«©åˆæ»‘è‚‰åˆä¸ºï¼Œè·Ÿè›‹ç™½ä¸€æ ·ï¼Œçœ‹è¿™å°èƒ³è†Šèƒ–çš„ä¸€è½±è¾˜ä¸€è½±è¾˜çš„ï¼Œ è·Ÿå»äº†çš®çš„è²è—•ä¸€æ ·ï¼Œè¿˜æœ‰è¿™å°è„šä¸«èƒ–çš„è·Ÿå°çŒªè¹„ä¼¼çš„ã€‚" è¿™æ—¶æˆ‘å§èµ¶ç´§æŠ±èµ·å­©å­è­¦æƒ•çš„çœ‹ç€æˆ‘è¯´:â€œä½ æ˜¯ä¸æ˜¯é¥¿äº†ï¼Œé”…é‡Œè¿˜æœ‰å‰©é¥­....."`,
  `å°æ˜ï¼šæˆ‘çˆ¸å¼€å…°åšåŸºå°¼ï¼Œæˆ‘å¦ˆå¼€æ³•æ‹‰åˆ©ã€‚ å°åˆšï¼šé‚£ä½ å‘¢ï¼Ÿ å°æ˜ï¼šæˆ‘å¼€ç©ç¬‘ï¼`,
  `ä¸€å¤©ï¼ŒèŸ‘è‚å«èœˆèš£å‡ºå»ç©ï¼ŒèŸ‘è‚ç­‰äº†ä¸¤ä¸ªå°æ—¶ï¼Œæ²¡æœ‰è€å¿ƒçš„è¯´äº†ä¸€å¥:â€œè€èœˆï¼Œä½ æ€ä¹ˆè¿˜æ²¡å‡ºæ¥å‘€ï¼Ÿâ€ èœˆèš£è¯´äº†ä¸€å¥:â€œç­‰ç­‰æˆ‘è¿˜åœ¨ç©¿é‹å‘¢ï¼`,
  `åˆ˜å¤‡æ‰¾äº†ä¸‰ä¸ªäººï¼Œèµ¢å¾—äº†å¤©ä¸‹ å”åƒ§æ‰¾äº†ä¸‰ä¸ªäººï¼Œå–å¾—äº†çœŸç» æˆ‘æ‰¾äº†ä¸‰ä¸ªäººï¼Œèµ¢äº†æˆ‘äº”ç™¾å¤š`,
  `åœ¨åŠå…¬å®¤å¼„äº†ä¸ªé±¼ç¼¸å…»äº†å‡ åªé€æ˜çš„è™¾ï¼Œé¢†å¯¼çœ‹è§äº†é—®æˆ‘å…»çš„å•¥ã€‚ æˆ‘è¯´:â€œè™¾å•Šï¼â€ æˆ‘çœ‹é¢†å¯¼è„¸è‰²ä¸å¤ªå¯¹ï¼Œæ„è¯†åˆ°è‡ªå·±è¯´é”™è¯äº†ï¼Œæ€¥å¿™è§£é‡Š: â€œé¢†å¯¼æ˜¯è™¾å•Šï¼ŒçœŸçš„æ˜¯è™¾å•Šï¼â€ç„¶åï¼Œç¬¬äºŒå¤©æˆ‘å°±è¢«å¼€é™¤äº†ã€‚`,
  `A:ä½ çŸ¥é“ä¸ºä»€ä¹ˆäººå’Œè½¦éƒ½è¦é å³èµ°ï¼Ÿ B:å› ä¸ºå®‰å…¨ï¼ A:NO NO NO,å› ä¸ºè©è¨ä¿ä½‘ï¼`,
  `A:å…ˆç”Ÿï¼Œå¬è¯´ä½ ç®—å‘½æŒºå‡†çš„ï¼Œç»™æˆ‘ä¹Ÿç®—ä¸€ä¸‹ã€‚ B:ä½ å‘€ï¼Œ20å²æ‹çˆ±ï¼Œ23å²å¨¶å¦»ï¼Œ 4å²å¾—å­å¥½è¿ä¸æ–­ï¼Œé˜–å®¶å›¢åœ†ã€‚ A:æ‰¯æ·¡ï¼Œæˆ‘éƒ½33å²äº†ï¼Œåšå£«æ¯•ä¸šï¼Œ è¿˜æ²¡è°ˆè¿‡æ‹çˆ±ã€‚ B:ä½ åšå£«æ¯•ä¸šï¼Ÿ A:æ˜¯å•Šï¼Œæ€ä¹ˆäº†ï¼Ÿ B:é‚£å°±å¯¹äº†ï¼ŒçŸ¥è¯†æ”¹å˜äº†ä½ çš„å‘½è¿ã€‚`,
  `æœ‰ä»€ä¹ˆæ¯”å’¬å¼€ä¸€ä¸ªè‹¹æœå‘ç°é‡Œé¢æœ‰è™«å­æ›´ç³Ÿç³•çš„äº‹å—ï¼Ÿ" :â€œå’¬å¼€åï¼Œå‘ç°è™«å­åªå‰©åŠæ¡äº†ã€‚`,
  `æˆ‘:å¦ˆï¼Œæˆ‘çš„æ—§è¡£æœå¸®æˆ‘æ‰“åŒ…ä¸€ä¸‹ï¼Œæˆ‘å‡†å¤‡æäº†ã€‚ è€å¦ˆ:ä¸è¦æäº†ï¼Œæ‰”äº†å§ã€‚ æˆ‘:åˆ«æ‰”ï¼Œè¿˜æœ‰å¥½å¤šåƒä¸ä¸Šé¥­çš„å­©å­éœ€è¦å‘¢ã€‚ è€å¦ˆ:è°å®¶åƒä¸ä¸Šé¥­çš„å­©å­ç©¿XXXXLï¼Ÿ`,
  `æœ‰ä¸€æ¬¡åœ¨èµ°å»Šä¸Šç¢°åˆ°æˆ‘ç”·ç¥ï¼ŒæŠŠæƒ…ä¹¦å¡ç»™ä»–å°±èµ¶ç´§è·‘äº†ï¼Œ å›åˆ°æ•™å®¤ä¸€æ‘¸å£è¢‹ï¼Œæƒ…ä¹¦è¿˜åœ¨ï¼Œä¸€å—é’±æ²¡äº†ã€‚`,
  `å”¯ä¸€å¯¹æˆ‘è¯´è¿‡ä¸è¦èµ°çš„åªæœ‰æˆ‘çš„ä½“è‚²è€å¸ˆ: â€œä¸è¦èµ°å¥½å—ï¼Ÿè·‘èµ·æ¥â€`,
  `è€å¸ˆ:ä¸ºä»€ä¹ˆè€ƒè¿™ä¹ˆä½ï¼Ÿ æˆ‘:è€å¸ˆï¼Œæˆ‘æé«˜ã€‚`,
  `A:ä¸ºä»€ä¹ˆè¢œå­æ€»æ˜¯åªä¸¢ä¸€åªï¼Ÿ B:ä¸çŸ¥é“ï¼Œæˆ‘ä¹Ÿè€æ˜¯ä¸¢ä¸€åªè¢œå­ã€‚ A:ç¬¨è›‹ï¼Œå› ä¸ºä¸¢ä¸¤åªä½ æ ¹æœ¬å°±ä¸ä¼šå‘ç°ã€‚`,
  `A:å°å¼ å¾ˆçˆ±ç¬‘ï¼Œ æ‰€ä»¥ä¸€ç›´è¿‡ä¸äº†å®‰æ£€ã€‚ B:ä¸ºä»€ä¹ˆï¼Ÿ A:å› ä¸ºä»–ç¬‘é‡Œè—åˆ€ã€‚`,
  `ä¸€å“¥ä»¬å„¿å–œæ¬¢ç½‘ä¸ŠèŠå¤©ï¼Œæœ‰æ¬¡å»å’Œå¥³ç½‘å‹è§é¢ï¼Œæˆ‘é—®ä»–ä»€ä¹ˆæƒ…å†µï¼Ÿä»–è¯´:â€œç¬”è¯•é€šè¿‡äº†ï¼Œé¢è¯•æ²¡é€šã€‚`,
  `ä¸€çŠ¯äººæ‰§è¡Œæªå†³ï¼Œ å­å¼¹è´¨é‡ä¸å¥½ï¼Œ ç¬¬ä¸€æªæ²¡æ”¾å‡ºï¼Œæ¥ç€åˆå¼€ç¬¬äºŒæª...ç¬¬ä¸‰æª... è¿™æ—¶çŠ¯äººå¤§å“­:â€œä½ æsæˆ‘å§ï¼Œå¤ªå“äººäº†ï¼`,
  `æ—è¾¹åºŠä½çˆ¸çˆ¸ä»å­©å­å‡ºç”Ÿåå°±çš±ä¸ªçœ‰ï¼Œæˆ‘ä»¥ä¸ºä»–ä¸æƒ³è¦é—ºå¥³ï¼Œç»“æœå¬ä»–ç»™å®¶äººæ‰“ç”µè¯è¯´ï¼Œå­©å­å“ªå“ªéƒ½æŒºå¥½ï¼Œå°±æ˜¯å…ˆå¤©æ®‹ç–¾ï¼Œ ä¸€å‡ºç”Ÿå°±æ²¡æœ‰ç‰™ã€‚`,
  `é»„æ¯›æ€ªæŠ“ä½äº†å­™æ‚Ÿç©ºç”¨æ¯«æ¯›å˜å‡ºæ¥çš„7ä¸ªå”åƒ§ï¼Œç™¾èŠ±å…¬ä¸»é—®ä»–ä¸ºä»€ä¹ˆæœ‰ä¸ƒä¸ªï¼Œä»–è¯´: â€œå¯èƒ½æ˜¯ä¸€ä¸ªç–—ç¨‹å§ï¼`,
  `å»é¬¼å±‹ç©ï¼Œ èº«ä»½è¯æ‰äº†ï¼Œç„¶åæ»¡é¬¼å±‹çš„é¬¼éƒ½åœ¨å«æˆ‘åå­—`,
  `æœ‰ä¸€ä¸ªäººè‡­å±å£°éŸ³å¾ˆå¤§ï¼Œä½ çŸ¥é“ä¸ºä»€ä¹ˆä¸ï¼Ÿ å› ä¸ºä»–ç©¿ç€å–‡å­è£¤ã€‚`,
  `æˆ‘:â€œè€æ¿ï¼Œæ˜å¤©æœ‰äº‹è¯·å‡ä¸€å¤©ï¼Œæœ›æ‰¹å‡†ã€‚" è€æ¿:â€œå¥½ï¼Œä½ ä¸ä¼šæ˜¯å»æ‰¾æ–°çš„å·¥ä½œäº†ï¼Ÿâ€ æˆ‘:â€œä¸å¯èƒ½ï¼Œæˆ‘å¯¹å…¬å¸å¿ å¿ƒè€¿è€¿ï¼Œè€æ¿æ‚¨è¯´è¿™è¯æˆ‘å°±ä¼¤å¿ƒäº†ã€‚â€ è€æ¿:â€œå…³é”®æ˜¯ä½ ç®€å†æŠ•åˆ°äº†æˆ‘å¦ä¸€å®¶å…¬å¸ã€‚â€ æˆ‘:â€œæ˜¯å•Šï¼Œæƒ³ä¸ºæ‚¨å‡ºä¸¤ä»½åŠ›ã€‚`,
  `ä¸€åªèœˆèš£æœ‰100æ¡è…¿ï¼Œåœ¨ä¸€æ¡ä¾¿ä¾¿ä¸Šé¢èµ°è¿‡å»ï¼Œä¸ºä»€ä¹ˆåªç•™ä¸‹äº†99ä¸ªè„šå°ã€‚ å› ä¸ºä»–è¦æä½é¼»å­ã€‚`,
  `å°èš¯èš“é—®èš¯èš“å¦ˆå¦ˆ:â€œå¦ˆå¦ˆï¼Œå¦ˆå¦ˆï¼Œçˆ¸çˆ¸å»å“ªäº†ï¼Ÿâ€ å°èš¯èš“å¦ˆå¦ˆè¯´: â€œçˆ¸çˆ¸é™ªäººé’“é±¼å»äº†`,
  `ä½ çŸ¥é“é£Ÿäººæ—å–œæ¬¢å»å“ªé‡Œåƒé¥­å—ï¼Ÿ ç­”æ¡ˆ:æ¸¸ä¹å›­ å› ä¸ºé‚£é‡Œ1.2ç±³ä»¥ä¸‹å„¿ç«¥å…è´¹ã€‚`,
  `å¦‚ä½•ä¸‰å¥è¯è®©ä¸€ä¸ªç”·äººä¸ºä½ èŠ±18ä¸‡: å¸…å“¥ è½¦æŠ€ä¸é”™å•Š ç»™æˆ‘æ’é£è¿™ä¹ˆè¿œ`,
  `åŒ»ç”Ÿ:â€œä½ è€å…¬éœ€è¦ç»å¯¹çš„å®‰é™ï¼Œè¿™æ˜¯å®‰çœ è¯ã€‚â€ å¥³å£«:â€œè°¢è°¢åŒ»ç”Ÿï¼Œ æˆ‘ä¼šæŒ‰æ—¶ç»™ä»–åƒçš„ã€‚" åŒ»ç”Ÿ:â€œå–”ï¼Œä¸ï¼ä½ è¯¯ä¼šäº†ï¼Œè¿™è¯æ˜¯ç»™ä½ çš„ã€‚`,
  `çˆ¶äº²æ•™å„¿å­å­¦ç®—æœ¯ çˆ¶äº²:ä¸€ä¸ªè‹¹æœåŠ ä¸€ä¸ªè‹¹æœæ˜¯å‡ ä¸ªè‹¹æœï¼Ÿ å„¿å­:ä¸çŸ¥é“ã€‚ çˆ¶äº²:æ˜¯ä¸¤ä¸ªï¼Œç¬¨è›‹ï¼çŸ¥é“äº†å—ï¼Ÿ å„¿å­:çŸ¥é“äº†ã€‚ çˆ¶äº²:é‚£ä¹ˆï¼Œæˆ‘å’Œä½ åŠ èµ·æ¥æ˜¯å‡ ä¸ªäººï¼Ÿ å„¿å­:æ˜¯ä¸¤ä¸ªç¬¨è›‹ï¼`,
  `æ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªäººç©¿çš„é‹å­æ˜¯æ–°çš„è¿˜æ˜¯æ—§çš„ï¼Ÿ é‚£å°±ç‹ ç‹ åœ°è¸©ä»–ä¸€è„šï¼Œ å¦‚æœå¯¹æ–¹è¯´â€œä½ è¸©æˆ‘è„šäº†ï¼â€é‚£å°±æ˜¯æ—§é‹ï¼Œå¦‚æœå¯¹æ–¹è¯´â€œä½ è¸©æˆ‘é‹äº†ï¼â€é‚£å°±ä¸€å®šæ˜¯æ–°é‹ï¼`,
  `ä»å‰æœ‰ä¸ªäººå§“é“ï¼Œä»–ä»å°å°±ä¸é•¿å¤´å‘ï¼Œè¯·é—®ä»–å¾—äº†ä»€ä¹ˆç—…ï¼Ÿç­”æ¡ˆï¼šè€é“æ²¡æ¯›ç—…ã€‚`,
  `åŒ»ç”Ÿï¼šæ”¾æ¾ï¼Œåˆ«ç´§å¼ æˆ´ç»´ï¼Œè¿™åªæ˜¯ä¸€æ¬¡å°æ‰‹æœ¯è€Œå·²ã€‚ç—…äººï¼šæˆ‘ä¸å«æˆ´ç»´ã€‚åŒ»ç”Ÿï¼šæˆ‘çŸ¥é“ï¼Œæˆ‘å«æˆ´ç»´ã€‚`,
  `å°è±¡æ‰¾åˆ°äº†ä¸€ä¸ªæ–°å·¥ä½œï¼Œå¦ˆå¦ˆé—®ä»–ä¸ºä»€ä¹ˆæ¯å¤©ä¸‹ç­å›æ¥éƒ½å¾ˆç”Ÿæ°”ï¼Œä»–è¯´ä»–åœ¨æ°”è±¡å±€ã€‚`,
  `è®¸ä»™ç»™ç™½å¨˜å­ä¹°äº†ä¸€é¡¶é¸­èˆŒå¸½ï¼Œç»“æœç™½å¨˜å­å¸¦ä¸Šä¹‹åå°±ä¸èƒ½åŠ¨äº†ã€‚ ä¸€-å‹è›‡å¸½`,
  `å¦ˆå¦ˆï¼šåŒå­¦è¯´ä½ ä¸‘ï¼Ÿ æˆ‘ï¼šçœŸçš„å—ï¼Ÿ å¦ˆå¦ˆï¼šåœ¨äººå¤šçš„åœ°æ–¹åˆ«å«æˆ‘å¦ˆå¦ˆï¼`,
  `åˆ«äººéƒ½æ˜¯ç¬‘èµ·æ¥å¾ˆå¥½çœ‹ï¼Œä½†æ˜¯ä½ å´ä¸ä¸€æ ·ï¼Œçœ‹èµ·æ¥å¾ˆå¥½ç¬‘ã€‚`,
  `ä¹å¹´ä¹‰åŠ¡æ•™è‚²æ•™è‚²åï¼Œæˆ‘å‘ç°æˆ‘å¯ä»¥åœ¨è¯•å·ä¸Šç¯¡æ”¹å†å²ï¼Œåˆ›é€ è¯­è¨€ï¼Œé¢ è¦†æ”¿æ²»ï¼Œæ§åˆ¶åœ°çƒï¼Œæ°”æ­»ç‰›é¡¿ï¼Œåˆæˆç‰©è´¨ï¼Œæ”¹å˜åŸºå› ã€‚`,
  `ä½ æœ‰ã€Šæ—¶é—´ç®€å²ã€‹å—ï¼Ÿ-æˆ‘æ²¡æ—¶é—´æ¡ï¼Œè°æœ‰æ—¶é—´æ¡é‚£ç©æ„ã€‚`,
  `æœ‰ä¸€å¤©ä¸Šè¯¾ï¼Œè€å¸ˆé—®å°ä¸½ï¼šâ€œç¥–å›½æ˜¯ä»€ä¹ˆ?â€å°ä¸½è¯´ï¼šâ€œè€å¸ˆï¼Œç¥–å›½æ˜¯æˆ‘çš„æ¯äº²ã€‚â€è€å¸ˆè¯´ï¼šâ€œå›ç­”çš„å¾ˆå¥½ã€‚â€æ¥ç€è€å¸ˆåˆé—®å°æ˜ï¼šâ€œå°æ˜ï¼Œç¥–å›½æ˜¯ä»€ä¹ˆå•Š?â€å°æ˜è¯´ï¼šâ€œè€å¸ˆï¼Œç¥–å›½æ˜¯æˆ‘ä¸ˆæ¯å¨˜ã€‚`,
  `æˆ‘å§è€ƒç‰¹å²—æ•™å¸ˆçš„æ—¶å€™ï¼Œ800åº¦è¿‘è§†æ²¡å¸¦çœ¼é•œï¼ŒèŠ±ä¸€ä¸ŠåˆæŠŠè§†åŠ›è¡¨èƒŒä¸‹æ¥äº†ï¼Œç»“æœæµ‹è¯•çš„æ—¶å€™æ²¡çœ‹è§æ£â€¦â€¦`,
  `æ˜¨å¤©ç”·ç¥ç»™æˆ‘å‘çŸ­ä¿¡è¯´ï¼šâ€œä»Šæ™šæˆ‘å®¶æ²¡äººâ€ï¼Œäºæ˜¯æˆ‘å»äº†ä»–å®¶ï¼Œæ•²äº†ä¸€ä¸ªå°æ—¶çš„é—¨ï¼Œæœç„¶æ²¡äººã€‚`,
  `ç»“å©šå¤šå¹´ï¼Œç¡åˆ°åŠå¤œï¼Œè€å…¬çªç„¶è½¬è¿‡èº«ç´§ç´§æŠ±ä½è€å©†è¯´ï¼šè€å©†è¿™è¾ˆå­å¤ªçŸ­äº†ã€‚è€å©†é†’è¿‡æ¥å¬åˆ°è¿™å¥è¯æ„ŸåŠ¨å¾—æ‰ä¸‹çœ¼æ³ªï¼Œè€å…¬æ¥ç€è¯´ï¼šæˆ‘tméƒ½ç›–ä¸åˆ°è„šã€‚`,
  `æˆ‘å¯¹è€å¦ˆè¯´ï¼šâ€œå¤©å¤©åœ¨å®¶åƒéƒ½åƒè…»äº†ï¼Œè¦ä¸ä»Šå¤©å»å¤–é¢åƒï¼Ÿâ€ è€å¦ˆæƒ³äº†æƒ³ï¼Œç‚¹äº†ç‚¹å¤´ã€‚ç„¶åç»™æˆ‘ç››äº†ä¸€ç¢—é¥­è®©æˆ‘ä¸€ä¸ªäººå»å¤–é¢é™¢å­é‡Œåƒã€‚`,
  `è€å¸ˆé—®ï¼šâ€œè°èƒ½ç”¨â€˜ä¸€...å°±...â€™é€ å¥ï¼Ÿâ€ å°æ˜ï¼šâ€œæˆ‘ä¸€æƒ³åˆ°å­¦ä¹ ï¼Œå°±å¤´ç–¼ã€‚â€ è€å¸ˆï¼šâ€œæ¢ä¸€ä¸ªã€‚â€ å°æ˜ï¼šâ€œæˆ‘ä¸€è¯´å®è¯ï¼Œä½ å°±ç”Ÿæ°”ã€‚â€`,
];

    // ---------------- çŠ¶æ€ä¸å­˜å‚¨ ----------------
    const $ = (sel) => document.querySelector(sel);
    const state = {
      user: null,
      index: 0,
      intervalId: null,
      paused: false,
      progressTimer: null,
    };
    const STORAGE_KEY = 'hahaha_users'; // { [username]: { pass: string, favs: string[] } }

    function loadUsers() {
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; } catch { return {}; }
    }
    function saveUsers(users) { localStorage.setItem(STORAGE_KEY, JSON.stringify(users)); }

    // å½“å‰ç”¨æˆ·æ”¶è—ç›¸å…³
    function getUserFavs() { return state.user ? (loadUsers()[state.user]?.favs || []) : []; }
    function setUserFavs(nextFavs) {
      if (!state.user) return;
      const users = loadUsers();
      if (!users[state.user]) users[state.user] = { pass: '', favs: [] };
      users[state.user].favs = nextFavs;
      saveUsers(users);
      renderFavSection();
      syncFavBtn();
    }

    // ---------------- UI æ¸²æŸ“ ----------------
    function setText(el, text) { el.textContent = text; }

    function renderJoke() {
      const text = JOKES[state.index];
      const el = $('#jokeText');
      // åŠ¨ç”»ï¼š
      el.classList.remove('fade-enter-active');
      el.classList.add('fade-exit');
      void el.offsetWidth; // è§¦å‘é‡ç»˜
      el.classList.remove('fade-exit');
      el.classList.add('fade-enter');
      setText(el, 'â€œ' + text + 'â€');
      void el.offsetWidth;
      el.classList.add('fade-enter-active');

      setText($('#jokeIndex'), String(state.index + 1));
      setText($('#jokeTotal'), String(JOKES.length));
      syncFavBtn();
      restartProgress();
    }

    function syncFavBtn() {
      const favs = getUserFavs();
      const id = String(state.index);
      const isFav = favs.includes(id);
      const btn = $('#favBtn');
      btn.setAttribute('aria-pressed', isFav ? 'true' : 'false');
      $('#favIcon').textContent = isFav ? 'â˜…' : 'â˜†';
      btn.querySelector('span:last-child').textContent = isFav ? 'å·²æ”¶è—' : 'æ”¶è—';
    }

    function renderFavSection() {
      const list = $('#favList');
      const favs = getUserFavs();
      list.innerHTML = '';
      $('#favCountLabel').textContent = `${favs.length} æ¡`;
      $('#noFavTip').classList.toggle('hidden', favs.length !== 0);
      favs.forEach((idStr) => {
        const idx = parseInt(idStr, 10);
        const li = document.createElement('li');
        li.className = 'rounded-2xl border border-white/10 bg-white/5 p-5';
        li.innerHTML = `
          <div class="text-sm text-white/60 mb-2">ç¬¬ ${idx + 1} æ¡</div>
          <div class="text-lg leading-relaxed">â€œ${JOKES[idx]}â€</div>
          <div class="mt-4 flex gap-2">
            <button data-jump="${idx}" class="px-3 py-2 rounded-lg bg-white text-black text-sm hover:opacity-90">è·³è½¬æ’­æ”¾</button>
            <button data-remove="${idx}" class="px-3 py-2 rounded-lg border border-white/10 text-sm hover:bg-white/10">å–æ¶ˆæ”¶è—</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    // è¿›åº¦æ¡ï¼ˆ60 ç§’å¾ªç¯ï¼‰
    function restartProgress() {
      const bar = $('#progress');
      clearInterval(state.progressTimer);
      bar.style.width = '0%';
      let elapsed = 0;
      const total = 60_000; // 60 ç§’
      const tick = 100; // 0.1s åˆ·æ–°
      state.progressTimer = setInterval(() => {
        if (state.paused) return;
        elapsed += tick;
        const pct = Math.min(100, (elapsed / total) * 100);
        bar.style.width = pct + '%';
        if (pct >= 100) clearInterval(state.progressTimer);
      }, tick);
    }

    // ---------------- è½®æ’­æ§åˆ¶ ----------------
    function nextJoke() {
      state.index = (state.index + 1) % JOKES.length;
      renderJoke();
    }
    function prevJoke() {
      state.index = (state.index - 1 + JOKES.length) % JOKES.length;
      renderJoke();
    }
    function startAuto() {
      clearInterval(state.intervalId);
      state.intervalId = setInterval(() => { if (!state.paused) nextJoke(); }, 60_000);
    }

    // ---------------- ç™»å½•æ¨¡å—ï¼ˆä»…æœ¬åœ°ï¼‰ ----------------
    function updateAuthUI() {
      const loggedIn = Boolean(state.user);
      $('#loginBtn').classList.toggle('hidden', loggedIn);
      $('#userBtn').classList.toggle('hidden', !loggedIn);
      $('#usernameText').textContent = loggedIn ? state.user : '';
    }

    function openLogin() { $('#loginModal').classList.remove('hidden'); $('#loginName').focus(); }
    function closeLogin() { $('#loginModal').classList.add('hidden'); }

    function login(username, password) {
      const users = loadUsers();
      if (!users[username]) users[username] = { pass: password, favs: [] };
      // ç®€æ˜“éªŒè¯ï¼ˆä»…æœ¬åœ°ç”¨é€”ï¼Œä¸è¦ç”¨äºç”Ÿäº§ï¼‰
      if (users[username].pass !== password) {
        alert('å¯†ç ä¸æ­£ç¡®');
        return false;
      }
      saveUsers(users);
      state.user = username;
      updateAuthUI();
      renderFavSection();
      return true;
    }

    function logout() {
      state.user = null;
      updateAuthUI();
    }

    // ---------------- äº‹ä»¶ç»‘å®š ----------------
    document.addEventListener('click', (e) => {
      const t = e.target;
      if (t.id === 'nextBtn') nextJoke();
      if (t.id === 'prevBtn') prevJoke();
      if (t.id === 'pauseBtn') {
        state.paused = !state.paused;
        t.textContent = state.paused ? 'ç»§ç»­' : 'æš‚åœ';
      }
      if (t.id === 'favBtn') {
        if (!state.user) { openLogin(); return; }
        const favs = new Set(getUserFavs());
        const id = String(state.index);
        if (favs.has(id)) favs.delete(id); else favs.add(id);
        setUserFavs([...favs].sort((a,b)=>Number(a)-Number(b)));
      }
      if (t.id === 'viewFavsBtn') {
        $('#jokesSection').classList.add('hidden');
        $('#favsSection').classList.remove('hidden');
        renderFavSection();
      }
      if (t.id === 'viewJokesBtn') {
        $('#favsSection').classList.add('hidden');
        $('#jokesSection').classList.remove('hidden');
      }
      if (t.id === 'loginBtn') openLogin();
      if (t.id === 'loginClose') closeLogin();
      if (t.id === 'userBtn') {
        const dd = $('#userDropdown');
        dd.classList.toggle('hidden');
        const expanded = dd.classList.contains('hidden') ? 'false' : 'true';
        t.setAttribute('aria-expanded', expanded);
      }
      if (t.id === 'logoutBtn') { logout(); $('#userDropdown').classList.add('hidden'); }
      if (t.id === 'clearFavBtn') {
        if (!state.user) return;
        if (confirm('ç¡®è®¤æ¸…ç©ºå…¨éƒ¨æ”¶è—ï¼Ÿ')) setUserFavs([]);
        $('#userDropdown').classList.add('hidden');
      }

      // æ”¶è—åˆ—è¡¨ä¸­çš„è·³è½¬ä¸ç§»é™¤
      if (t.matches('[data-jump]')) {
        const idx = Number(t.getAttribute('data-jump'));
        state.index = idx; renderJoke();
        $('#viewJokesBtn').click();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
      if (t.matches('[data-remove]')) {
        const idx = String(t.getAttribute('data-remove'));
        const favs = getUserFavs().filter(id => id !== idx);
        setUserFavs(favs);
      }
    });

    // ç™»å½•è¡¨å•
    $('#loginForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const u = $('#loginName').value.trim();
      const p = $('#loginPass').value.trim();
      if (!u || !p) return;
      const ok = login(u, p);
      if (ok) closeLogin();
    });

    // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰
    document.addEventListener('click', (e) => {
      if (!$('#userMenu').contains(e.target)) $('#userDropdown').classList.add('hidden');
    });

    // ---------------- åˆå§‹åŒ– ----------------
    (function init() {
      setText($('#year'), new Date().getFullYear());
      renderJoke();
      startAuto();
      updateAuthUI();
    })();
  </script>
</body>
</html>
